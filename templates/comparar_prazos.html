{% extends 'base.html' %}
{% block title %}Comparar Prazos{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/comparar_prazos.css') }}">
{% endblock %}

{% block content %}
<div class="alert alert-info">
    <i class="fas fa-info-circle me-2"></i>
    Compare os prazos de entrega entre o sistema ONCLICK e os marketplaces.
</div>

<h2 class="mb-4">Verificar Prazos ONCLICK | Marketplace</h2>  

<form id="compararForm" method="POST" enctype="multipart/form-data">
    <div class="mb-3">
        <label for="arquivo_erp" class="form-label">Planilha(ONCLICK):</label>
        <input type="file" class="form-control" id="arquivo_erp" name="arquivo_erp" accept=".xlsx,.xls,.csv" required>
    </div>
    <div class="mb-3">
        <label for="arquivo_marketplace" class="form-label">Planilha Marketplace:</label>
        <input type="file" class="form-control" id="arquivo_marketplace" name="arquivo_marketplace" accept=".xlsx,.xls,.csv" required>
    </div>
    <div class="d-flex align-items-center gap-2 mt-3">
        <button id="btnProcessar" type="submit" class="btn btn-primary">COMPARAR PRAZOS</button>
        <div id="downloadContainer"></div>
    </div>
</form>

<!-- Área de Log -->
<div class="mt-4">
    <h5>Log de Processamento:</h5>
    <div id="logContainer" class="bg-light p-3 rounded" style="height: 300px; overflow-y: auto; font-size: 1.1em;">
        <span class="text-muted">Aguardando processamento...</span>
    </div>
</div>

<!-- Popup de processamento -->
<div id="processingPopup" style="display: none; position: fixed; bottom: 80px; right: 30px; background: #0d6efd; color: white; padding: 15px 20px; border-radius: 10px; z-index: 1050; box-shadow: 0 4px 12px rgba(0,0,0,0.25); min-width: 220px;">
    <div style="display: flex; align-items: center; gap: 12px;">
        <div id="popupIcon">
            <div class="spinner-border spinner-border-sm" style="width: 1.5rem; height: 1.5rem;"></div>
        </div>
        <div>
            <div id="popupText" style="font-weight: 500; font-size: 1.1rem;">Processando...</div>
            <div id="processingTimer" style="font-family: 'Courier New', monospace; font-size: 1.2rem; margin-top: 4px; color: white;">00:00</div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/comparar_prazos.js') }}"></script>
{% endblock %}